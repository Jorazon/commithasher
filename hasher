#!/bin/bash

TARGET="000" # The target pattern (3 leading zeros)
MESSAGE=$(git log -1 --pretty=format:"%s") # original commit message
COUNT=1

# ASCII characters set: 0-9, A-Z, a-z
CHARS=({0..9} {A..Z})

# Function to generate random trailing data
generate_trailing_data() {
  TRAILING=""
  for i in {1..6}; do  # Length of trailing data, adjust as needed
    TRAILING+="${CHARS[RANDOM % ${#CHARS[@]}]}"
  done
  echo "$TRAILING"
}

while true; do
  # Generate trailing characters
  TRAILING_DATA=$(generate_trailing_data)

  # Amend the commit with additional trailing data
  git commit --amend -m "$MESSAGE #$TRAILING_DATA" --no-edit > /dev/null 2>&1

  # Get the new hash
  HASH=$(git log -1 --pretty=format:"%h")

  # Check if the hash matches the required pattern
  if [[ "$HASH" == $TARGET* ]]; then
    echo "Found matching hash: $HASH"
    break
  fi
done
